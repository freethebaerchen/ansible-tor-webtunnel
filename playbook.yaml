---

- name: Setup Infrastructure in HCloud
  hosts: localhost
  become: no
  roles:
    - hetzner
  tags:
    - infrastructure
    - hetzner
    - hcloud

- name: Setup general system
  hosts: all
  become: yes
  roles:
    - system
  tags:
    - system
    - general

- name: Setup the WebSocket Bridge
  hosts: all
  become: yes
  roles:
    - tor
  tags:
    - tor
    - bridge
    - webtunnel

- name: Setup webserver
  hosts: all
  become: yes
  roles: 
    - webserver
  tags:
    - webserver

- name: Shutdown
  hosts: test
  become: yes
  tags:
    - shutdown
  tasks:
    - name: Shutdown server {{ inventory_hostname }}
      community.general.shutdown: